1. 创建conda环境并激活

2. 安装所用到的库

```bash
pip install -r requirements.txt
```

3. 去到Gurobi官网，下载Gurobi Optimizer，并获取免费许可证

```
下载地址：
https://support.gurobi.com/hc/en-us/articles/4534161999889-How-do-I-install-Gurobi-Optimizer
获取官方免费通行证地址：
https://portal.gurobi.com/iam/login/?target=https%3A%2F%2Fportal.gurobi.com%2Fiam%2Flicenses%2Flist%2F
注册并登入
```



![image-20250806025756302](image-20250806025756302.png)



```bash
运行服务
uvicorn main:app --reload
```

对系统进行提问，比如：
```text
你是谁？
```
或者询问专业的调度问题：
```text
额定容量为400MWh，额定功率为100MW，电价预测，对后面24小时的电价预测，时间间隔是30分钟，单位是元/kWh:[0.32, 0.24, 0.24, 0.25, 0.26, 0.3, 0.31, 0.29, 0.32, 0.37, 0.41, 0.44, 0.44, 0.45, 0.46, 0.47, 0.47, 0.47, 0.46, 0.42, 0.35, 0.29, 0.23, 0.24, 0.25, 0.29, 0.29, 0.23, 0.25, 0.22, 0.21, 0.21, 0.2, 0.18, 0.17, 0.16, 0.16, 0.13, 0.12, 0.11, 0.1, 0.1, 0.12, 0.12, 0.12, 0.14, 0.15, 0.17 ],碳价序列：[0.08, 0.08, 0.07, 0.09, 0.08, 0.05, 0.07, 0.06, 0.07, 0.06, 0.07, 0.08, 0.06, 0.06, 0.06, 0.08, 0.07, 0.1, 0.08, 0.09, 0.07, 0.08, 0.07, 0.06, 0.05, 0.09, 0.08, 0.09, 0.1, 0.08, 0.05, 0.09, 0.07, 0.08, 0.08, 0.09, 0.09, 0.07, 0.06, 0.05, 0.06, 0.08, 0.07, 0.09, 0.09, 0.08, 0.06, 0.07]请帮我做一个24小时间隔为0.5小时的决策调度，请给出完整的时间调度计划，并做出总结。

```

#### 设计思路

1. **先自构建2000+数据集，再使用Llama-Factory，进行LoRA微调。**

  据我微调的经验来说吧应该，Qwen3-8B是比较合适的（需要至少16GB，24GB的显存），不用刻意花大量数据去训练它调用工具的能力，就已经可以很好实现了，如果是1.5B这样的参量的，可能需要花多一点的数据去训练模型调用特定工具的能力。

  然后我这边主要训练的是模型的一些关于储能电站知识库，为模型提供一些先验知识，还有一些语言风格使其专业平滑，输出格式比较专业，小数据训练其调用指定工具的能力，关于数据集的构建我采用的是Alpaca风格的，然后可以去找一些相关的文献，然后用AI技术/自动化技术获取其中的知识，以及人工构设计参数智能补全和意图识别的案例，构建指令式数据集，部分调整语言风格可能需要人工标注了，但也可以通过前辈们训练的AI去做这件事情（前人栽树，后人乘凉），也可以用自己之前训练的AI。

2. **根据上一步收集到的准确的资料来构建fassi向量库，并自己构建智能体流和一些约束条件的规则库，后续也可以自己添加**

  因为相对于其他大佬微调的AI来说，我们的数据集还是比较少的，因此呢我们需要用RAG的技术来增强我们模型的知识能力。

3. **工具设计**

  做这种储能电站调度问题，那么如果是让大模型完全的自我决策，自己寻找方法计算经济效益和物理场模型显然是不太现实和精准的，那么我们就需要自己构建一些工具来供大模型使用，比如合适的计算方法，多目标优化模型，来评估这样调度的经济效益，从而可以寻优，找到最好的调度方案。按LLM-Tool的调用机制，这边计算方法采用的是Gurobi数学规划求解器，是一个很优秀的商用求解器，需要自己去官网申请，免费的许可证就够了，如果做超过一天的调度可能需要专业的许可证。

  另外也可以自己集成一些其他的工具，因为我希望这个模型在专业领域上不只是可以用作调度，同样可以用作其他的方面，比如知识问答，根据天气评估一些手段，措施，这样就需要集成一个天气API的工具。





4. **系统开发**

  因为希望快速开发且功能尚未设计完整的业务流程，所以采用了简单的前端三件套 + 后端FastAPI快速本地部署，在Vue3方面比较会调组件库一些，前端三件套实操的还是比较少的，由于是一个人且项目也没那么看重业务就没做前后端分离。

  一个小亮点就是对Markdown语法实现了编译，对表格做出了特殊的样式，以及界面采用了渐变色的形式，下面有实际的展示。
  
https://github.com/user-attachments/assets/7663b182-edd1-4efe-8952-b2016a9c252a

<video src="\AI问答.mp4"></video>
  总结来说项目还是比较完善，由于模型微调模型太大了我就没有上传，各位可以自己操作，总的来说还是用了一个上下文工程的操作，RAG的模式以及结合LoRA微调算是把这些AI技术结合做的一个应用，目前我们也在对专利进行申请，困扰~~~~

  一个小小的结果展示：
![image-20250806025756302](2007-01-19.svg)
![image-20250806025756302](2008-02-29.svg)
  模型还是能比较好的权衡经济收益、寿命、碳排放三目标，能在高抛低购，其中经济收益中也包含了碳交易市场，各种成本的计算（包括基于DoD深度的退化成本），这里只做架构分析，具体计算设计不做过多赘述。
